{"paragraphs":[{"text":"%sql\nCREATE EXTERNAL TABLE amazon_reviews_parquet(\n  marketplace string, \n  customer_id string, \n  review_id string, \n  product_id string, \n  product_parent string, \n  product_title string, \n  star_rating int, \n  helpful_votes int, \n  total_votes int, \n  vine string, \n  verified_purchase string, \n  review_headline string, \n  review_body string, \n  review_date bigint, \n  year int)\nPARTITIONED BY (product_category string)\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'\nLOCATION\n  's3://amazon-reviews-pds/parquet/'","user":"anonymous","dateUpdated":"2019-03-27T06:54:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":94,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1553669004913_719292169","id":"20190327-064324_1203142809","dateCreated":"2019-03-27T06:43:24+0000","dateStarted":"2019-03-27T06:47:04+0000","dateFinished":"2019-03-27T06:48:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4542"},{"text":"%sql\nMSCK REPAIR TABLE amazon_reviews_parquet\n","user":"anonymous","dateUpdated":"2019-03-27T06:55:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":144,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-50-150.ec2.internal:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1553669224173_-539625662","id":"20190327-064704_75010110","dateCreated":"2019-03-27T06:47:04+0000","dateStarted":"2019-03-27T06:53:27+0000","dateFinished":"2019-03-27T06:53:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4543"},{"text":"%sql\nCREATE EXTERNAL TABLE IF NOT EXISTS amzn (\n  marketplace string, \n  customer_id string, \n  review_id string, \n  product_id string, \n  product_parent string, \n  product_title string, \n  star_rating int, \n  helpful_votes int, \n  total_votes int, \n  vine string, \n  verified_purchase string, \n  review_headline string, \n  review_body string, \n  review_date bigint, \n  year int\n)\nPARTITIONED BY (product_category string)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t' LINES TERMINATED BY '\\n'\nSTORED AS TEXTFILE\nLOCATION 'hdfs:///user/hive/warehouse/amzn/'","user":"anonymous","dateUpdated":"2019-03-27T06:58:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":124,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1553669742745_-1475527051","id":"20190327-065542_293025670","dateCreated":"2019-03-27T06:55:42+0000","dateStarted":"2019-03-27T06:58:27+0000","dateFinished":"2019-03-27T06:58:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4544"},{"text":"%sql\nMSCK REPAIR TABLE amzn\n","user":"anonymous","dateUpdated":"2019-03-27T06:59:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1553669923108_-254015610","id":"20190327-065843_365100377","dateCreated":"2019-03-27T06:58:43+0000","dateStarted":"2019-03-27T06:59:10+0000","dateFinished":"2019-03-27T06:59:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4545"},{"text":"%pyspark\nspark.sql(\"\"\"SET spark.hadoop.mapred.output.compress = true\"\"\")\nspark.sql(\"\"\"SET spark.hadoop.mapred.output.compression.codec = true\"\"\")\nspark.sql(\"\"\"SET spark.hadoop.mapred.output.compression.codec = org.apache.hadoop.io.compress.GzipCodec\"\"\")\nspark.sql(\"\"\"SET spark.hadoop.mapred.output.compression.type = BLOCK\"\"\")\n\nspark.sql(\"\"\"SET mapred.output.compress = true\"\"\")\nspark.sql(\"\"\"SET hive.exec.compress.output = true\"\"\")\nspark.sql(\"\"\"SET mapred.output.compression.codec = org.apache.hadoop.io.compress.GzipCodec\"\"\")\nspark.sql(\"\"\"SET io.compression.codecs = org.apache.hadoop.io.compress.GzipCodec\"\"\")\n\nspark.sql(\"\"\"SET spark.sql.shuffle.partitions = 500\"\"\")\nspark.sql(\"\"\"SET spark.yarn.executor.memoryOverhead = 4096\"\"\")\nspark.sql(\"\"\"SET hive.exec.dynamic.partition.mode=nonstrict\"\"\")\n","user":"anonymous","dateUpdated":"2019-03-27T07:11:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[key: string, value: string]\n"}]},"apps":[],"jobName":"paragraph_1553670245189_-1676750345","id":"20190327-070405_1753190493","dateCreated":"2019-03-27T07:04:05+0000","dateStarted":"2019-03-27T07:11:52+0000","dateFinished":"2019-03-27T07:11:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4546"},{"text":"%sql\nINSERT OVERWRITE TABLE amzn PARTITION(product_category)\nSELECT\n    marketplace, \n    customer_id, \n    review_id,\n    product_category,\n    product_id, \n    product_parent, \n    product_title, \n    star_rating, \n    helpful_votes, \n    total_votes, \n    vine, \n    verified_purchase, \n    review_headline, \n    review_body, \n    review_date, \n    year\nFROM\n    amazon_reviews_parquet\nWHERE\n    year = 2015\n    AND product_category = 'Watches'","user":"anonymous","dateUpdated":"2019-03-27T07:11:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.UnsupportedOperationException: org.apache.parquet.column.values.dictionary.PlainValuesDictionary$PlainIntegerDictionary\n\tat org.apache.parquet.column.Dictionary.decodeToLong(Dictionary.java:49)\n\tat org.apache.spark.sql.execution.datasources.parquet.ParquetDictionary.decodeToLong(ParquetDictionary.java:36)\n\tat org.apache.spark.sql.execution.vectorized.OnHeapColumnVector.getLong(OnHeapColumnVector.java:364)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$11$$anon$1.hasNext(WholeStageCodegenExec.scala:619)\n\tat org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:216)\n\tat org.apache.spark.sql.execution.SortExec$$anonfun$1.apply(SortExec.scala:108)\n\tat org.apache.spark.sql.execution.SortExec$$anonfun$1.apply(SortExec.scala:101)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$24.apply(RDD.scala:836)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitionsInternal$1$$anonfun$apply$24.apply(RDD.scala:836)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:121)\n\tat org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:402)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:408)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-50-150.ec2.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1553669440818_745425447","id":"20190327-065040_258105792","dateCreated":"2019-03-27T06:50:40+0000","dateStarted":"2019-03-27T07:11:57+0000","dateFinished":"2019-03-27T07:12:18+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:4547"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2019-03-27T07:01:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1553670111793_1736496845","id":"20190327-070151_625696197","dateCreated":"2019-03-27T07:01:51+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4548"}],"name":"Amazon_Watches_Reviews_EDA","id":"2E8XG5BJV","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}