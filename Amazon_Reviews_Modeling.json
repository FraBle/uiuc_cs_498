{"paragraphs":[{"text":"%sql\nCREATE TEMPORARY VIEW amzn_reviews\nUSING org.apache.spark.sql.parquet\nOPTIONS (\n    path 's3://amazon-reviews-pds/parquet/' \n)\n","user":"anonymous","dateUpdated":"2019-04-17T03:28:08+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":11,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":114,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678337_-1506561615","id":"20190328-003828_1738161649","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:235","dateFinished":"2019-04-17T03:28:51+0000","dateStarted":"2019-04-17T03:28:09+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=0","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%sql\nSELECT * FROM amzn_reviews LIMIT 10","user":"anonymous","dateUpdated":"2019-04-17T03:29:01+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"marketplace":"string","customer_id":"string","review_id":"string","product_id":"string","product_parent":"string","product_title":"string","star_rating":"string","helpful_votes":"string","total_votes":"string","vine":"string","verified_purchase":"string","review_headline":"string","review_body":"string","review_date":"string","year":"string","product_category":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"marketplace\tcustomer_id\treview_id\tproduct_id\tproduct_parent\tproduct_title\tstar_rating\thelpful_votes\ttotal_votes\tvine\tverified_purchase\treview_headline\treview_body\treview_date\tyear\tproduct_category\nUS\t15444933\tR1WWG70WK9VUCH\t1848192576\t835940987\tStanding Qigong for Health and Martial Arts - Zhan Zhuang\t5\t9\t10\tN\tY\tInformative AND interesting!\tAfter attending a few Qigong classes, I wanted to have a book to read and re-read the instructions so I could practice at home.  I also wanted to gain more of an understanding of the purpose and benefit of the movements in order to practice them with a more focused purpose.<br /><br />The book exceeded my expectations.  The explanations are very clear and are paired with photos showing the correct form.  The book itself is more than just the Qigong, it's a very interesting read.  I read the whole book in two days and will read it again. I rarely read books twice!  The book has provided the information and additional instruction that I was looking for. I even use the breathing exercise to de-stress in traffic and fall asleep at night.  It really works!  I bought the book for my sister also and she's started practicing Standing Qigong and loves it.\t2015-05-02\t2015\tBooks\nUS\t20595117\tR1EQ3POS0RIOD5\t145162445X\t574044348\tA Universe from Nothing: Why There Is Something Rather than Nothing\t4\t4\t7\tN\tN\tBetween 'Nothing' and 'Nothing' somehow we are 'Something'  'Yes' to the Science ,'No' to the anti- Theology\tKrauss traces the remarkable transformation in cosmological understanding which has come with the Einstein- Hubble era. He explains how the great question of twentieth- century Physics i.e. Whether the Universe is contracting or flat or expanding has been decisively answered in favor of Expansion. He provides a dramatic picture of our own present time in the Universe as a very special one in which we are capable of observing one- hundred billion galaxies. He says that we will come to a time when all galaxies  will expand away from us but our own and we will be left with the ability to observe only our own Galaxy. He gives the scenarios for the ultimate outcome in disintegration of our Galaxy. He also provides a picture of the Universe in which the very stuff we are made of, the atomic matter is a small portion of the total stuff of the universe. The Dark Energy and Dark Matter which Krauss has himself worked to detect are the factor leading to the Universe's expansion. All of this Krauss wants to argue makes us not only insignificant to the universe as a whole but even more insignificant than was previously thought.<br />Our long- term future then as he understands it is 'miserable' oblivion, back to 'Nothingness'.<br />As Krauss understands it then there is no long- term hope for Humanity and certainly no long term hope for any kind of salvation from a personal God. Krauss even wants to as it were 'prove' that our Universe came not by Divine Creation but from Nothing, a Nothing which he calls the 'Laws of Physics'. All this is discouraging to someone like myself who does believe and pray to a personal God. And who believes that there is more in Heaven and Earth ( And in the human future) than Lawrence Krauss understands.\t2012-06-29\t2012\tBooks\nUS\t52925878\tR10SRJA4VVGUBD\t055341805X\t846590203\tHyacinth Girls: A Novel\t4\t0\t0\tY\tN\tMysteries upon mysteries\tRebecca, a dental hygienist, receives a call at work and must rush to school, where she learns that thirteen-year-old Cassie has been accused of bullying, of throwing ink on another girl. Rebecca, who is Cassie's guardian (since both of Cassie's parents are dead), cannot bring herself to believe that Cassie would do such a thing. One witness, however, claims that the supposed victim actually covered herself with paint, perhaps in an act intended to get Cassie in trouble. Another witness claims Cassie did indeed commit the act. But soon, a bunch of girls emerges claiming that Cassie is innocent. Rebecca goes with this story. What exactly happened is the first mystery.<br /><br />&#34;Hyacinth Girls&#34; is told in a far-from-linear style, and we soon begin to see pieces of Rebecca's childhood, her fast friendships, and the escapades that girls, who see themselves on a mission to save others and fancy themselves as possessing a psychic bond, get into. For example, when another girl turns up missing, Rebecca and her cohorts convince themselves that a local man is holding the missing girl hostage in his basement, and they concoct a plan to investigate. The full nature of Rebecca's childhood is the second mystery.<br /><br />The first mystery deepens when threatening letters begin to arrive, and the emotional level increases dramatically.<br /><br />While reading &#34;Hyacinth Girls,&#34; I was reminded of the film &#34;Heavenly Creatures&#34; and of novels like Stephen Dobyns's &#34;Church of the Dead Girls.&#34; The former came to mind because of the Hyacinth Girls' almost obsessive relationship with each other, and the latter came to mind because of the style of the book, the slow revealing of the truth that comes through an obviously biased narrator (well, two since both Rebecca and Cassie tell about half of the story). Since I enjoyed both &#34;Heavenly Creatures&#34; and &#34;Church of the Dead Girls,&#34; those associations speak well for &#34;Hyacinth Girls.&#34;\t2015-05-02\t2015\tBooks\nUS\t40062567\tRD3268X41GM7U\t0425263908\t119148606\tBared to You\t5\t1\t1\tN\tN\t\"RAW, STEAMY, HYPNOTIC!\"\t\\\\\"BARED TO YOU\\\\\" is a sizzling, red-hot passionate romance you cannot forget, made for the Big Screen! Sylvia Day is a talented author who aims to please and a Winner in this sensual story as she delivers scorching love scenes in this incredible Crossfire Novel. Eva and Gideon come to life as the author describes their Obsession to each other. Eva's addiction is Gideon, a clever man, candy-coated on the outside, and damaged on the inside. Eva knows what she wants and how to capture his heart. A Masterpiece that's beautifully written and Highly Recommended!\t2012-06-29\t2012\tBooks\nUS\t47221489\tR3KGQL5X5BSJE1\t1416556141\t987400385\tHealer: A Novel\t5\t0\t0\tN\tY\tWell written story\tGood characters and plot line. I spent a pleasureable time reading this book.  I enjoyed the writing as well as the growth of the characters and the solution to their circumstances.  This was a realistic view of a conundrum that could be found easily today.\t2015-05-02\t2015\tBooks\nUS\t20709973\tR3IY9A2Z7N2R49\t1455523003\t181218559\tThe Missionary Position: Mother Teresa in Theory and Practice\t4\t5\t7\tN\tY\tEye opening, yet somehow not the whole story...\tThis book was fascinating. It started with the slight laugh I got from the title, but then got more serious as I got further into the book. Coming into this book I didn't have very much of an opinion of Mother Teresa, so you might say that I could easily be persuaded one way or the other in this debate. However, I have tried to balance out my intake of information of Mother Teresa, and I hope that now I can write an honest and accurate review of this book.<br /><br />Hitchens starts his expose on Mother Teresa, in a section titled \\\\\"A Miracle,\\\\\" by talking about her interesting and totally accidental rise to fame. Mother Teresa apparently became famous because she was filmed in a dark room with new Kodak film which made the room lighter, and before the truth about the new film could be told, the director of the documentary had spread the story that a miracle had occurred and that Mother Teresa had lit up the room with her presence. Weird.<br /><br />The second part was the most influential when it comes to scarring Mother Teresa's name. Titled \\\\\"Good Works and Heroic Virtues,\\\\\" this section goes into detail about several incidents where Mother Teresa made decisions that just made me cringe. Maybe these were isolated incidents, but Hitchens makes a good case against Mother Teresa and this was probably the defining section of the whole book. Without this section, which contains evidence against the moral and saintly nature of Mother Teresa, this book would be extremely bankrupt of any real hard evidence against Mother Teresa.<br /><br />The last section is titled \\\\\"Ubiquity,\\\\\" which talks about the political side of Mother Teresa, and how she claimed to be above and beyond, or just downright not interested in politics, yet she still used her influence heavily in the realm of politics. I found this section somewhat based of speculation more than proven fact, but it still added to the case against Mother Teresa and was quite worth the paper it was printed on.<br /><br />All in all, I think this was worth my time. However, I still think that Hitchens played this one a little too far out into left field. What I have heard from so many different people who have worked with Mother Teresa directly or indirectly makes it seems like there is more to the story. However, this is certainly worth the read and is a thought provoking book. The only reason it is not 5 stars is because the burden of proof was placed on Hitchens, and I think he dropped the ball a little (only a little!) in the last section.n all, I think this was worth my time. However, I still think that Hitchens played this one a little too far out into left field. What I have heard from so many different people who have worked with Mother Teresa directly or indirectly makes it seems like there is more to the story. However, this is certainly worth the read and is a thought provoking book. The only reason it is not 5 stars is because the burden of proof was placed on Hitchens, and I think he dropped the ball a little (only a little!) in the last section.\t2012-06-29\t2012\tBooks\nUS\t18052694\tR12PGYPH9B9UVJ\t0990388697\t840404589\tI'm Tired of Being Ordinary, Are You?\t4\t1\t1\tN\tY\tJOY\tA personal world view by an original and creative author who really cares. A pleasurable and joyful read. Love his cover as well as the book.\t2015-05-02\t2015\tBooks\nUS\t48279565\tR2CA9LLJBEORNZ\t0345803485\t600633062\tFifty Shades of Grey: Book One of the Fifty Shades Trilogy (Fifty Shades of Grey Series)\t1\t7\t7\tN\tN\tThis book is Twilight with worse characters\tI bought this book because everyone was talking about it. I don't get why people think this is anything special. Maybe if you've never read any romance novels or you've never looked up free sexy stories online, then this book will be awesome for you. Also this book goes along with the sexist/uneducated stereotypes of the \\\\\"screwed up\\\\\" BDSM lifestyle mixing with an innocent idiot girl-next-door.\t2012-06-29\t2012\tBooks\nUS\t14297627\tR2C8BZMS1JRZ04\t1469245167\t466321651\tThe Thrill of Victory\t4\t0\t0\tN\tY\tFour Stars\tSandra Brown is always a great read.\t2015-05-02\t2015\tBooks\nUS\t37340439\tR2F8UI9NNP6S33\t0345803485\t600633062\tFifty Shades of Grey: Book One of the Fifty Shades Trilogy (Fifty Shades of Grey Series)\t5\t0\t9\tN\tN\tFifty shades of grey\tLoved this book! People kept telling me to read it, but I wasn't sure about it. I finally did and it was awesome. I love the story line and my husband is enjoying me reading it too. I have never read any book about sex before.\t2012-06-29\t2012\tBooks\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678343_-1284671478","id":"20190416-133705_870688845","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:236","dateFinished":"2019-04-17T03:29:07+0000","dateStarted":"2019-04-17T03:29:01+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"text":"%sql\nCREATE TEMPORARY VIEW amzn_item_lookup AS (\n    SELECT product_id, first(product_title) AS product_title, first(product_category) AS product_category\n    FROM amzn_reviews\n    GROUP BY product_id)","user":"anonymous","dateUpdated":"2019-04-17T03:29:03+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678344_512668903","id":"20190416-140521_584958542","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:237","dateFinished":"2019-04-17T03:29:07+0000","dateStarted":"2019-04-17T03:29:03+0000"},{"text":"%sql\nCREATE TEMPORARY VIEW amzn_reviews_cnt AS (\n   SELECT product_id, COUNT(*) AS cnt\n   FROM amzn_reviews\n   GROUP BY product_id)","user":"anonymous","dateUpdated":"2019-04-17T03:29:06+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678344_1264152882","id":"20190416-135402_1086550872","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238","dateFinished":"2019-04-17T03:29:07+0000","dateStarted":"2019-04-17T03:29:07+0000"},{"text":"%sql\nCREATE TEMPORARY VIEW amzn_reviews_mean AS (\n   SELECT product_id, \n          MEAN(star_rating) AS star_rating_mean,\n          MEAN(helpful_votes) AS helpful_votes_mean,\n          MEAN(total_votes) AS total_votes_mean\n        \n   FROM amzn_reviews\n   GROUP BY product_id)","user":"anonymous","dateUpdated":"2019-04-17T03:29:15+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678345_228349039","id":"20190416-135701_1492577635","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:239","dateFinished":"2019-04-17T03:29:16+0000","dateStarted":"2019-04-17T03:29:15+0000"},{"text":"%sql\nCREATE TEMPORARY VIEW amzn_reviews_agg AS (\n    SELECT amzn_item_lookup.product_id, product_title, product_category, cnt, amzn_reviews_mean.star_rating_mean, amzn_reviews_mean.helpful_votes_mean, amzn_reviews_mean.total_votes_mean\n    FROM amzn_item_lookup\n    INNER JOIN\n    amzn_reviews_cnt\n    ON amzn_item_lookup.product_id = amzn_reviews_cnt.product_id\n    INNER JOIN\n    amzn_reviews_mean\n    ON amzn_reviews_cnt.product_id = amzn_reviews_mean.product_id)","user":"anonymous","dateUpdated":"2019-04-17T03:29:19+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678345_1881173332","id":"20190416-135805_169513777","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:240","dateFinished":"2019-04-17T03:29:19+0000","dateStarted":"2019-04-17T03:29:19+0000"},{"text":"%sql\n-- Create an aggregrate dataset which we will use to train models\nSELECT * FROM amzn_reviews_agg LIMIT 5","user":"anonymous","dateUpdated":"2019-04-17T03:29:23+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"product_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"product_title","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""},{"name":"product_category","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"cnt","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"star_rating_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"helpful_votes_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"total_votes_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"product_id":"string","product_title":"string","product_category":"string","cnt":"string","star_rating_mean":"string","helpful_votes_mean":"string","total_votes_mean":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"product_id\tproduct_title\tproduct_category\tcnt\tstar_rating_mean\thelpful_votes_mean\ttotal_votes_mean\n0001714422\t'C' Is for Clown (Bright & Early Books)\tBooks\t2\t5.0\t3.5\t3.5\n0001837192\tPieter Brueghel's The fair: Story\tBooks\t3\t5.0\t0.3333333333333333\t0.3333333333333333\n0001845357\tBallad of Favour\tBooks\t1\t4.0\t0.0\t0.0\n0002005565\tThieves\tBooks\t1\t2.0\t2.0\t3.0\n0002151731\tThe Greatest Benefit to Mankind: A Medical History of Humanity\tBooks\t1\t2.0\t24.0\t60.0\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678346_-1864595885","id":"20190416-140315_1412606861","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:241","dateFinished":"2019-04-17T03:31:37+0000","dateStarted":"2019-04-17T03:29:23+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}}},{"text":"%sql\n-- Load book reviews\nCREATE TEMPORARY VIEW book_reviews\nUSING csv\nOPTIONS (\n    path \"s3://uiuc-cs-498-proj/RankingData/GoodBooks10k/books.csv\",\n    header \"true\"\n)","user":"anonymous","dateUpdated":"2019-04-17T03:43:04+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678346_229965145","id":"20190416-230722_285397366","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:242","dateFinished":"2019-04-17T03:31:45+0000","dateStarted":"2019-04-17T03:31:44+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}}},{"text":"%sql\nCREATE TEMPORARY VIEW book_reviews_rank AS (\n    SELECT title as product_title, percent_rank() OVER (ORDER BY average_rating ASC) as percent_rank FROM book_reviews\n    )","user":"anonymous","dateUpdated":"2019-04-17T03:32:25+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678347_462751971","id":"20190416-134737_1964959770","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:244","dateFinished":"2019-04-17T03:32:25+0000","dateStarted":"2019-04-17T03:32:25+0000"},{"text":"%sql\nCREATE TEMPORARY VIEW book_reviews_ds AS (\n    SELECT * FROM amzn_reviews_agg \n    LEFT JOIN\n    book_reviews_rank\n    ON amzn_reviews_agg.product_title = book_reviews_rank.product_title\n    WHERE amzn_reviews_agg.product_category = 'Books' AND\n        percent_rank IS NOT NULL\n    ORDER BY book_reviews_rank.percent_rank DESC\n)","user":"anonymous","dateUpdated":"2019-04-17T04:01:11+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"product_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"product_title","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""},{"name":"product_category","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"cnt","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"star_rating_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"helpful_votes_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"total_votes_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"percent_rank","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678347_1797627884","id":"20190416-144511_1419502242","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:245","dateFinished":"2019-04-17T04:00:49+0000","dateStarted":"2019-04-17T04:00:49+0000"},{"text":"%sql\n-- Load book reviews\nCREATE TEMPORARY VIEW movie_reviews\nUSING csv\nOPTIONS (\n    path \"s3://uiuc-cs-498-proj/RankingData/TheMoviesDataset/movies_metadata.csv\",\n    header \"true\"\n)","user":"anonymous","dateUpdated":"2019-04-17T03:44:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555472591424_-1409618412","id":"20190417-034311_1507148212","dateCreated":"2019-04-17T03:43:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18321","dateFinished":"2019-04-17T03:44:34+0000","dateStarted":"2019-04-17T03:44:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}}},{"text":"%sql\nCREATE TEMPORARY VIEW movie_reviews_rank AS (\n    SELECT title as product_title, percent_rank() OVER (ORDER BY vote_average ASC) as percent_rank FROM movie_reviews WHERE vote_count > 20\n    )","user":"anonymous","dateUpdated":"2019-04-17T03:53:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555472678872_-1758470650","id":"20190417-034438_1526850716","dateCreated":"2019-04-17T03:44:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18658","dateFinished":"2019-04-17T03:53:51+0000","dateStarted":"2019-04-17T03:53:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]}},{"text":"%sql\nCREATE TEMPORARY VIEW movie_reviews_ds AS (\n    SELECT * FROM amzn_reviews_agg \n    LEFT JOIN\n    movie_reviews_rank\n    ON amzn_reviews_agg.product_title = movie_reviews_rank.product_title\n    WHERE amzn_reviews_agg.product_category = 'Video_DVD' AND\n        percent_rank IS NOT NULL\n    ORDER BY book_reviews_rank.percent_rank DESC\n)","user":"anonymous","dateUpdated":"2019-04-17T04:01:17+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"marketplace","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"customer_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"review_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"product_id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"product_parent","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""},{"name":"product_title","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"star_rating","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"helpful_votes","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"total_votes","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"vine","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"verified_purchase","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"review_headline","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"review_body","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"review_date","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"year","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"product_category","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1555471678348_-1567432141","id":"20190328-003955_1088007731","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246","dateFinished":"2019-04-17T03:58:06+0000","dateStarted":"2019-04-17T03:58:06+0000"},{"text":"%sql\n-- Load video games reviews\nCREATE TEMPORARY VIEW video_games_reviews\nUSING csv\nOPTIONS (\n    path \"s3://uiuc-cs-498-proj/RankingData/VideoGameSalesWithRatings/Video_Games_Sales_as_at_22_Dec_2016.csv\",\n    header \"true\"\n)","user":"anonymous","dateUpdated":"2019-04-17T04:08:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555474005739_-1513132099","id":"20190417-040645_1132911739","dateCreated":"2019-04-17T04:06:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:31557","dateFinished":"2019-04-17T04:08:46+0000","dateStarted":"2019-04-17T04:08:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=25"],"interpreterSettingId":"spark"}}},{"text":"%sql\nCREATE TEMPORARY VIEW video_games_reviews_rank AS (\n    SELECT Name as product_title, percent_rank() OVER (ORDER BY Critic_Score ASC) as percent_rank FROM video_games_reviews\n    )","user":"anonymous","dateUpdated":"2019-04-17T04:11:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555474144637_-1911843433","id":"20190417-040904_768189867","dateCreated":"2019-04-17T04:09:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:31938","dateFinished":"2019-04-17T04:11:41+0000","dateStarted":"2019-04-17T04:11:41+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]}},{"text":"%sql\nCREATE TEMPORARY VIEW video_games_reviews_ds AS (\n    SELECT * FROM amzn_reviews_agg \n    LEFT JOIN\n    video_games_reviews_rank\n    ON amzn_reviews_agg.product_title = video_games_reviews_rank.product_title\n    WHERE amzn_reviews_agg.product_category = 'Video_Games' AND\n        percent_rank IS NOT NULL\n    ORDER BY video_games_reviews_rank.percent_rank DESC\n)","user":"anonymous","dateUpdated":"2019-04-17T04:13:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555474248755_-482767291","id":"20190417-041048_664583281","dateCreated":"2019-04-17T04:10:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32253","dateFinished":"2019-04-17T04:13:31+0000","dateStarted":"2019-04-17T04:13:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]}},{"text":"%sql\nSELECT * FROM video_games_reviews_ds LIMIT 10","user":"anonymous","dateUpdated":"2019-04-17T04:16:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"product_id":"string","product_title":"string","product_category":"string","cnt":"string","star_rating_mean":"string","helpful_votes_mean":"string","total_votes_mean":"string","percent_rank":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555474420750_-663119991","id":"20190417-041340_626379362","dateCreated":"2019-04-17T04:13:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32864","dateFinished":"2019-04-17T04:16:36+0000","dateStarted":"2019-04-17T04:13:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"product_id\tproduct_title\tproduct_category\tcnt\tstar_rating_mean\thelpful_votes_mean\ttotal_votes_mean\tproduct_title\tpercent_rank\nB000FII8CO\tGrand Theft Auto IV\tVideo_Games\t6\t3.6666666666666665\t0.3333333333333333\t1.1666666666666667\tGrand Theft Auto IV\t0.9998205526976911\nB0045EI7I4\tGrand Theft Auto IV\tVideo_Games\t220\t4.540909090909091\t1.1363636363636365\t1.9954545454545454\tGrand Theft Auto IV\t0.9998205526976911\nB0007LZI8Q\tTony Hawk's Pro Skater 2\tVideo_Games\t3\t3.6666666666666665\t0.0\t4.333333333333333\tTony Hawk's Pro Skater 2\t0.9998205526976911\nB004Y38600\tGrand Theft Auto IV\tVideo_Games\t4\t4.75\t0.5\t1.0\tGrand Theft Auto IV\t0.9998205526976911\nB0045EI7I4\tGrand Theft Auto IV\tVideo_Games\t220\t4.540909090909091\t1.1363636363636365\t1.9954545454545454\tGrand Theft Auto IV\t0.9998205526976911\nB000RFUVE8\tGrand Theft Auto IV\tVideo_Games\t56\t4.589285714285714\t2.125\t3.8214285714285716\tGrand Theft Auto IV\t0.9998205526976911\nB000RFUVE8\tGrand Theft Auto IV\tVideo_Games\t56\t4.589285714285714\t2.125\t3.8214285714285716\tGrand Theft Auto IV\t0.9998205526976911\nB00004TEXJ\tTony Hawk's Pro Skater 2\tVideo_Games\t12\t3.3333333333333335\t3.0833333333333335\t4.083333333333333\tTony Hawk's Pro Skater 2\t0.9998205526976911\nB004Y38600\tGrand Theft Auto IV\tVideo_Games\t4\t4.75\t0.5\t1.0\tGrand Theft Auto IV\t0.9998205526976911\nB000FII8CO\tGrand Theft Auto IV\tVideo_Games\t6\t3.6666666666666665\t0.3333333333333333\t1.1666666666666667\tGrand Theft Auto IV\t0.9998205526976911\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=26","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=27"],"interpreterSettingId":"spark"}}},{"text":"%sql\nCREATE TEMPORARY VIEW amzn_reviews_ds AS (\n    SELECT * FROM\n    book_reviews_ds\n    UNION\n    SELECT * FROM\n    movie_reviews_ds\n    UNION\n    SELECT * FROM\n    video_games_reviews_ds\n)","user":"anonymous","dateUpdated":"2019-04-17T04:17:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555474440929_622669569","id":"20190417-041400_834704870","dateCreated":"2019-04-17T04:14:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32967","dateFinished":"2019-04-17T04:17:07+0000","dateStarted":"2019-04-17T04:17:06+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""},{"type":"TEXT","data":""}]}},{"text":"%sql\nSELECT * FROM amzn_reviews_ds LIMIT 4","user":"anonymous","dateUpdated":"2019-04-17T04:43:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"product_id":"string","product_title":"string","product_category":"string","cnt":"string","star_rating_mean":"string","helpful_votes_mean":"string","total_votes_mean":"string","percent_rank":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555474642637_2007915606","id":"20190417-041722_1057643401","dateCreated":"2019-04-17T04:17:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:34341","dateFinished":"2019-04-17T04:43:08+0000","dateStarted":"2019-04-17T04:39:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"product_id\tproduct_title\tproduct_category\tcnt\tstar_rating_mean\thelpful_votes_mean\ttotal_votes_mean\tproduct_title\tpercent_rank\n1438243561\tThe Richest Man in Babylon\tBooks\t11\t4.545454545454546\t0.8181818181818182\t1.0909090909090908\tThe Richest Man in Babylon\t0.8131813181318132\n1629100064\tThe Velveteen Rabbit\tBooks\t8\t4.875\t0.75\t0.875\tThe Velveteen Rabbit\t0.8809880988098809\nB000BLNP1E\tMonster\tBooks\t20\t3.6\t1.15\t1.9\tMonster\t0.19111911191119113\nB0073PBFUO\tParadise Lost\tBooks\t2\t5.0\t0.0\t0.0\tParadise Lost\t0.19111911191119113\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=48","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=47","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=49","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=50","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=51"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nimport pandas as pd\nimport numpy as np\nfrom sklearn import linear_model\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\n\n# select feature and target columns\ntraining_features = ['cnt', 'star_rating_mean', 'helpful_votes_mean', 'total_votes_mean']\ntraining_target = ['percent_rank']\n\n# scale input variables\nscaler = StandardScaler()\ndf = sqlContext.table(\"amzn_reviews_ds\")\ndf = df.toPandas()\nscaler.fit(df[training_features])\nX = scaler.transform(df[training_features])\ny = df[training_target]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# train a model to learn from the dataset\nlasso = linear_model.Lasso(alpha=0.01)\nlasso.fit(X_train,y_train)\ntrain_score=lasso.score(X_train,y_train)\ntest_score=lasso.score(X_test,y_test)\ncoeff_used = np.sum(lasso.coef_!=0)\nprint(\"training score:\", train_score)\nprint(\"test score: \", test_score)\nprint(\"number of features used: \", coeff_used)\n\n# print best features\nprint(\"\\ntop features:\")\nfor coef in reversed(sorted(lasso.coef_)):\n    if coef > 0:\n        coef_index = list(lasso.coef_).index(coef)\n        print(\"{} ({})\".format(training_features[coef_index], coef))","user":"anonymous","dateUpdated":"2019-04-17T04:20:52+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"/usr/local/lib64/python2.7/site-packages/sklearn/preprocessing/data.py:645: DataConversionWarning: Data with input dtype int64, float64 were all converted to float64 by StandardScaler.\n  return self.partial_fit(X, y)\n<string>:16: DataConversionWarning: Data with input dtype int64, float64 were all converted to float64 by StandardScaler.\n('training score:', 0.025851604688959084)\n('test score: ', 0.023586496121103306)\n('number of features used: ', 3)\n\ntop features:\nstar_rating_mean (0.0295160267452)\ncnt (0.0193198515535)\ntotal_votes_mean (0.00265953810417)\n"}]},"apps":[],"jobName":"paragraph_1555471678353_-2086092360","id":"20190403-234559_376621052","dateCreated":"2019-04-17T03:27:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:260","dateFinished":"2019-04-17T04:24:04+0000","dateStarted":"2019-04-17T04:20:52+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=33","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=34","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=35","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=36","http://ip-172-31-64-237.ec2.internal:4040/jobs/job?id=37"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndf.to_csv('/tmp/amzn_reviews_ds.csv', header=True, index=False, encoding='utf-8')","user":"anonymous","dateUpdated":"2019-04-17T04:45:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555475159771_2021890000","id":"20190417-042559_718313310","dateCreated":"2019-04-17T04:25:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:34938","dateFinished":"2019-04-17T04:45:52+0000","dateStarted":"2019-04-17T04:45:50+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-04-17T04:45:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1555476309466_1123821855","id":"20190417-044509_734836188","dateCreated":"2019-04-17T04:45:09+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:36008"}],"name":"Amazon_Reviews_Modeling","id":"2E96CHD9M","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}